<-
q()
library(LearnBayes)
Sys.Date()
data("studentdata")
summary(studentdata)
library(tidyverse)
glimpse(studentdata)
ggplot(mtcars) +
geom_point(aes(mpg, disp))
knitr::opts_chunk$set(results = "markup")
library(LearnBayes)
library(tidyverse)
ggplot(mtcars) +
geom_point(aes(mpg, disp))
knitr::opts_chunk$set(results = "markup")
library(LearnBayes)
library(tidyverse)
ggplot(mtcars) +
geom_point(aes(mpg, disp))
knitr::opts_chunk$set(results = "markup")
library(LearnBayes)
library(tidyverse)
ggplot(mtcars) +
geom_point(aes(mpg, disp))
head(iris)
library(sde)
?sde
?sde.sim
sde.sim
sde.sim(model="BS")
sde.sim(model="BS", t0 = 0, T = 0, X0 = 5, N = 10)
sde.sim
sde.sim(model="BS", t0 = 0, T = 0, X0 = 5, N = 10, M = 10)
clipr::write_clip(sde.sim)
sde.sim %>% clipr::write_clip()
libary(tidyverse)
library(tidyverse)
sde.sim %>% clipr::write_clip()
sde.sim %>% write.table("clipboard")
sde.sim
sde.sim(model="BS", t0 = 0, T = 0, X0 = 5, N = 10, M = 10)
traceback()
sde.sim(model="BS", t0 = 0, T = 0, X0 = 5, N = 10, M = 10, theta = c(1, 0.01))
sde.sim(model="BS", t0 = 0, T = 2, X0 = 5, N = 10, M = 10, theta = c(1, 0.01))
sde.sim(model="BS", t0 = 0, T = 2, X0 = 5, N = 10, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 10, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 10, M = 1, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 1, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 10, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 100, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 10, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 20, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5, N = 20, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5, N = 20, M = 10, theta = c(1, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5, N = 20, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = 20, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5, N = 20, M = 10, theta = c(1, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5, N = 20, M = 10, theta = c(0.98, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,  M = 10, theta = c(0.98, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,  M = 10, theta = c(0.98, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,  M = 10, theta = c(0.98, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,  M = 10, theta = c(0.98, 0.01)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,  M = 10, theta = c(0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,N = 10,  M = 10, theta = c(0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,N = 10, theta = c(0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 10, X0 = 5,theta = c(0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 100, X0 = 5, theta = c(0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 100, X0 = 5, theta = c(0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,N = 10, theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 10, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 2, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1)) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5,theta = c(-0.98, 0.1), M = 1000) -> xx
dim(xx)
sde.sim(model="BS", t0 = 0, T = 40, X0 = 5,theta = c(-0.98, 0.1), M = 1000) -> xx
plot(xx)
xx[,1] %>% plot
xx %>% apply(1, quantile, c(0.1,0.5,0.9))
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% plot()
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t()
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% head()
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column()
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% head
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value))
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 40,N = 40 X0 = 5,theta = c(-0.98, 0.1), M = 1000) -> xx
sde.sim(model="BS", t0 = 0, T = 40, N = 40, X0 = 5,theta = c(-0.98, 0.1), M = 1000) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 0, N = ) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = ) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, N = ) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(1, 0.1)) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
dim(xx)
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(1, 0.1)) -> xx
xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(1, 0.1), M = 10) -> xx
xx
dim(xx)
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10, N = 100) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10, N = 1) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 0, X0 = 5, theta = c(-1, 0.1), M = 10, N = 1) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10, N = 3) -> xx
sde.sim(model="BS", t0 = 0, T = 0, X0 = 5, theta = c(-1, 0.1), M = 10, N = 1) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10, N = 3) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 40, X0 = 5, theta = c(-1, 0.1), M = 10, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 10, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
dim(xx)
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 1000, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 1000, N = 40) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 5, theta = c(-1, 0.1), M = 1000, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 1, T = 1, X0 = 5, theta = c(1, 0.1), M = 1000, N = 40) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(-1, 0.1), M = 1000, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(1, 0.1), M = 1000, N = 40) -> xx
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent))
xx %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent)) + scale_y_reverse()
head(xx)
xx %>%  t() %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent)) + scale_y_reverse()
xx %>% as.data.frame() %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname = as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value)) + geom_path(aes(group=percent)) + scale_y_reverse()
knitr::knit_hooks$set(crop = knitr::hook_pdfcrop)
knitr::opts_chunk$set(fig.path = "Rmd_fig/",
dev = c("png", "cairo_pdf"),
pdf.options(family = "Japan1GothicBBB"),
dev.args=list(cairo_pdf = list(family = "Japan1GothicBBB"),
X11 = list(pdf.options = "Japan1GothicBBB")), # 日本語使うとエラーが多く出るため
fig.width = 5, fig.asp = 1,  # fig.widthの単位はインチ（4inch = 10cm = A4の半分）
fig.align = "center", comment = "", crop = T, fig.retina = 2)
knitr::opts_chunk$set(warning=FALSE,message = FALSE)
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(1, 0.1), M = 1000, N = 40) -> xx
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(1, 0.1), M = 1000, N = 40) -> xx
xx %>% as.data.frame() %>% rownames_to_column() %>%
gather(-rowname, key=percent, value=value) %>%
mutate(rowname = as.numeric(rowname)) %>%
ggplot(aes(x = rowname, y = value)) +
geom_path(aes(group=percent), color = "grey") + scale_y_reverse()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(1, 0.1), M = 1000, N = 40) -> xx
xx %>% as.data.frame() %>% rownames_to_column() %>%
gather(-rowname, key=percent, value=value) %>%
mutate(rowname = as.numeric(rowname)) %>%
ggplot(aes(x = rowname, y = value)) +
geom_path(aes(group=percent, color = percent)) + scale_y_reverse()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(1, 0.1), M = 1000, N = 40) -> xx
xx %>% as.data.frame() %>% rownames_to_column() %>%
gather(-rowname, key=percent, value=value) %>%
mutate(rowname = as.numeric(rowname)) %>%
ggplot(aes(x = rowname, y = value)) +
geom_path(aes(group=percent, color = percent)) + scale_y_reverse() + theme(legend.position = "none")
sde.sim(model="BS", theta = c(.5, .2), delta=0.01)
X <- sde.sim(model="BS", theta = c(.5, .2), delta=0.01)
plot(X)
X <- sde.sim(model="BS", theta = c(.5, .2), delta=0.01)
X
rcBS
?rcBS
pcBS()
pcBS(theta=c(0.5,0.3))
pcBS(0.5, theta=c(0.5,0.3))
pcBS(x=0.5, theta=c(0.5,0.3))
pcBS(x=0.5, Dt = 1 theta=c(0.5,0.3))
pcBS(x=0.5, Dt = 1, theta=c(0.5,0.3))
traceback()
pcBS
pcBS(x=0.5,x0=0, Dt = 1, theta=c(0.5,0.3))
pcBS(x=0.5,x0=0, Dt = 1, theta=c(0.5,0.3))
pcBS(x=0.5,x0=1, Dt = 1, theta=c(0.5,0.3))
rcBS(theta=c(0.5,0.1))
rcBS(x0 = 1, theta=c(0.5,0.1))
rcBS(Dt = 1, x0 = 1, theta=c(0.5,0.1))
rcBS(n = 10000, Dt = 1, x0 = 1, theta=c(0.5,0.1)) %>% hist()
X <- sde.sim(model="BS", theta = c(.5, .2), Dt=1)
X <- sde.sim(model="BS", theta = c(.5, .2))
?sde.sim
sde.sim
rcBS
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(1, 0.1), M = 1000, N = 40) -> xx
xx %>% dim
xx[2, ] %>% quantile
xx[2, ] %>% boxplot()
rcBS(n = 10000, Dt = 1, x0 = 1, theta=c(0.5,0.1)) %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 1000) -> xx
xx[2, ] %>% boxplot()
rcBS(n = 10000, Dt = 1/40, x0 = 1, theta=c(0.5,0.1)) %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 1000, N = 1) -> xx
xx[2, ] %>% boxplot()
xx[2, ] %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1) %>% plot
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = .1) %>% plot
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 10) %>% plot
sde.sim(model="BS", t0 = 0, T = 11, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 10) %>% plot
sde.sim(model="BS", t0 = 0, T = 11, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 10, delta=1) %>% plot
sde.sim(model="BS", t0 = 0, T = 11, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 10, delta=10) %>% plot
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=10) %>% plot
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1) %>% plot
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 40) %>% plot
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 40) %>% plot
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1) %>% plot
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 3) %>% plot
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 5) %>% plot
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 5) %>% dim
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 5, delta=0.1) %>% dim
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 5, delta=0.1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=0.1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 10, delta=0.1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 10, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=10) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 10, delta=10) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=10) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 1, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.05, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.5, 0.1), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.05, 0.1), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.05, 0.01), M = 10, N = 40, delta=40) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 1, X0 = 41, theta = c(0.05, 0.01), M = 10, N = 1, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% .[2,] %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% .[2,] %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 10, N = 40, delta=1) %>% plot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% dim
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% head()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowid=as.numeric(rowid)) %>% head()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>%head()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowid=as.numeric(rowid)) %>% head()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>%head8
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>%head()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% head()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% head()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 5, theta = c(-0.05, 0.01), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.1), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.3, 0.1), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.3, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% head
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% dim
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% .[2,] %>% quantile
sde.sim(model="BS", t0 = 0, T = 40, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% .[2,] %>% quantile
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% .[2,] %>% quantile
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 10, N = 40, delta=1) %>% .[2,] %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.01), M = 1000, N = 40, delta=1) %>% .[2,] %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.1), M = 1000, N = 40, delta=1) %>% .[2,] %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% .[2,] %>% boxplot()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1, 0.5, 0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)+scale_y_log10()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)+scale_y_log10()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)+scale_y_log10()+geom_point()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)+geom_point()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.1,0.5,0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)+geom_point()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.2,0.5,0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)+geom_point()
sde.sim(model="BS", t0 = 0, T = 41, X0 = 1, theta = c(0.05, 0.05), M = 1000, N = 40, delta=1) %>% apply(1, quantile, c(0.2,0.5,0.9)) %>% t %>% as.data.frame() %>%  rownames_to_column() %>% gather(-rowname, key=percent, value=value) %>% mutate(rowname=as.numeric(rowname)) %>% ggplot(aes(x = rowname, y = value, group=percent))+ geom_path()+geom_hline(yintercept = 1)+geom_point()+geom_hline(yintercept = 5)
library(sf)
?st_as_sf
install.packages(c("debugme", "gmapsdistance", "irlba", "kokudosuuchi", "miniCRAN", "purrr", "satellite", "sjPlot"))
getwd()
setwd("gasoline_value/")
dir()
file.edit("gasoline_value.R")
source('C:/Users/ofk/Desktop/gasoline_value/gasoline_value.R', encoding = 'UTF-8', echo=TRUE)
# 直近一か月のガソリン価格の推移
gasoline
365\7
365/7
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(52)
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52)
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
labs(title = paste0("最新調査日：", latest_survey_date))
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(breaks = "1 week")
?scale_x_date
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "1 week")
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "2 week")
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "2 week", labels = element_text(angle = 30))
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "2 week") +
labs(title = paste0("最新調査日：", latest_survey_date))  +
theme(axis.text.x = element_text(angle = 30))
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "2 week") +
labs(title = paste0("最新調査日：", latest_survey_date))  +
theme(axis.text.x = element_text(angle = 30, vjust = 0))
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "2 week") +
labs(title = paste0("最新調査日：", latest_survey_date))  +
theme(axis.text.x = element_text(angle = 30, vjust = 1))
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "2 week") +
labs(title = paste0("最新調査日：", latest_survey_date))  +
theme(axis.text.x = element_text(angle = 30, vjust = .5))
# 直近一か月のガソリン価格の推移
gasoline %>%
arrange(desc(調査日)) %>%
slice(1:52) %>%
ggplot(aes(x = 調査日, y = 全国)) +
geom_path() +
scale_x_date(date_breaks = "4 week") +
labs(title = paste0("直近52週(約1年)のガソリン価格の推移  最新調査日：", latest_survey_date))  +
theme(axis.text.x = element_text(angle = 30, vjust = .5))
ggsave("change_in_gasoline_prices(latest_1year).png")
ggsave("change_in_gasoline_prices.png")
library(rvest)
library(magrittr)
library(readxl)
library(readr)
library(ggplot2)
library(dplyr)
tmp <- tempfile(fileext = ".xls")
download.file(url = file_url, destfile = tmp, mode = "wb")
# -----------------------
# ダウンロードファイルの読込
# -----------------------
gasoline <-
readxl::read_xls(path = tmp, sheet = "レギュラー", col_types = "numeric") %>%
filter(!is.na(調査日))
source('C:/Users/ofk/Desktop/gasoline_value/gasoline_value.R', encoding = 'UTF-8', echo=TRUE)
# レギュラーガソリンの価格推移
ggplot(gasoline) +
geom_path(aes(x = 調査日, y = 全国)) +
labs(title = paste0("これまでのガソリン価格の推移   最新調査日：", latest_survey_date))
# レギュラーガソリンの価格推移
ggplot(gasoline) +
geom_path(aes(x = 調査日, y = 全国)) +
scale_x_date(date_breaks = "1 year") +
labs(title = paste0("これまでのガソリン価格の推移   最新調査日：", latest_survey_date))
# レギュラーガソリンの価格推移
ggplot(gasoline) +
geom_path(aes(x = 調査日, y = 全国)) +
scale_x_date(date_breaks = "1 year") +
labs(title = paste0("これまでのガソリン価格の推移   最新調査日：", latest_survey_date)) +
theme(axis.text.x = element_text(angle = 30, vjust = .5))
# レギュラーガソリンの価格推移
ggplot(gasoline) +
geom_path(aes(x = 調査日, y = 全国)) +
scale_x_date(date_breaks = "2 year") +
labs(title = paste0("これまでのガソリン価格の推移   最新調査日：", latest_survey_date)) +
theme(axis.text.x = element_text(angle = 30, vjust = .5))
ggsave("change_in_gasoline_prices.png")
getwd()
paste0(getwd(), "gasoline_prices.xls")
# -----------------------
# ファイルのダウンロード
# -----------------------
enecho_url <- "http://www.enecho.meti.go.jp/statistics/petroleum_and_lpgas/pl007/results.html"
file_url <-
read_html(enecho_url) %>%
rvest::html_nodes(xpath = "//ul[@class='ulist']/li/a") %>%
html_attr("href") %>%
.[1]
file_url <- paste0("http://www.enecho.meti.go.jp/statistics/petroleum_and_lpgas/pl007/",
file_url)
# -----------------------
# ファイルのダウンロード
# -----------------------
enecho_url <- "http://www.enecho.meti.go.jp/statistics/petroleum_and_lpgas/pl007/results.html"
file_url <-
read_html(enecho_url) %>%
rvest::html_nodes(xpath = "//ul[@class='ulist']/li/a") %>%
html_attr("href") %>%
.[1]
library(rvest)
library(magrittr)
library(readxl)
library(readr)
library(ggplot2)
library(dplyr)
# -----------------------
# ファイルのダウンロード
# -----------------------
enecho_url <- "http://www.enecho.meti.go.jp/statistics/petroleum_and_lpgas/pl007/results.html"
file_url <-
read_html(enecho_url) %>%
rvest::html_nodes(xpath = "//ul[@class='ulist']/li/a") %>%
html_attr("href") %>%
.[1]
file_url <- paste0("http://www.enecho.meti.go.jp/statistics/petroleum_and_lpgas/pl007/",
file_url)
tmp <- paste0(getwd(), "gasoline_prices.xls")
download.file(url = file_url, destfile = tmp, mode = "wb")
dir()
getwd()
tmp
tmp <- paste0(getwd(), "/gasoline_prices.xls")
download.file(url = file_url, destfile = tmp, mode = "wb")
source('C:/Users/ofk/Desktop/gasoline_value/gasoline_value.R', encoding = 'UTF-8', echo=TRUE)
